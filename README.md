# 快速上手分类模型深度学习

纯c实现，c99标准，不依赖任何第三方库， 集训练和使用为一体。

# 编译
```
gcc -std=c99 ./llm.c -lm -O3 -o llm
```

# 使用
- -i 输入维度
- -h 参数数量
- -o 输出维度
- -l 学习率
- -e 训练次数
- -m 最大样本数
- -n 输出间隔
- -t 指定该参数进入训练模式
- -f 训练文件路径
- -s 模型的路径


# 例子
假如有测试数据如下/tmp/iris.csv，最后一列是分类tag
```5.1,3.5,1.4,0.2,1
4.9,3,1.4,0.2,1
4.7,3.2,1.3,0.2,1
4.6,3.1,1.5,0.2,1
5,3.6,1.4,0.2,1
5.4,3.9,1.7,0.4,1
4.6,3.4,1.4,0.3,1
5,3.4,1.5,0.2,1
4.4,2.9,1.4,0.2,1
4.9,3.1,1.5,0.1,1
5.4,3.7,1.5,0.2,1
4.8,3.4,1.6,0.2,1
4.8,3,1.4,0.1,1
4.3,3,1.1,0.1,1
5.8,4,1.2,0.2,1
5.7,4.4,1.5,0.4,1
5.4,3.9,1.3,0.4,1
5.1,3.5,1.4,0.3,1
5.7,3.8,1.7,0.3,1
5.1,3.8,1.5,0.3,1
5.4,3.4,1.7,0.2,1
5.1,3.7,1.5,0.4,1
4.6,3.6,1,0.2,1
5.1,3.3,1.7,0.5,1
4.8,3.4,1.9,0.2,1
5,3,1.6,0.2,1
5,3.4,1.6,0.4,1
5.2,3.5,1.5,0.2,1
5.2,3.4,1.4,0.2,1
4.7,3.2,1.6,0.2,1
4.8,3.1,1.6,0.2,1
5.4,3.4,1.5,0.4,1
5.2,4.1,1.5,0.1,1
5.5,4.2,1.4,0.2,1
4.9,3.1,1.5,0.2,1
....
```
## 开始训练
```
# 训练模式 4个输入 100个隐藏层 4个输出 150个样本 测试数据路径/tmp/iris.csv 训练次数1000
./llm -t -i 4 -h 100 -o 4 -m 150 -f /tmp/iris.csv -e 1000
```
## 输出
```
==============start================
MODEL=train
INPUT_SIZE=4
HIDDEN_SIZE=100
OUTPUT_SIZE=4
LEARNING_RATE=0.010000
EPOCHS=1000
CSV_FILE=/tmp/iris.csv
MODEL_FILE=model.dat
==============END================
样本数量超过最大限制 (150)。
加载了 150 个样本
Epoch 10, Loss: 616.3378
Epoch 20, Loss: 90.9281
Epoch 30, Loss: 165.6126
Epoch 40, Loss: 170.9043
Epoch 50, Loss: 136.3390
Epoch 60, Loss: 84.8453
Epoch 70, Loss: 99.7717
Epoch 80, Loss: 159.0505
Epoch 90, Loss: 155.1534
....
```
## 验证
```
./llm -f /tmp/iris.csv
```
## 输出
```
模型加载成功。
==============start================
MODEL=test
INPUT_SIZE=4
HIDDEN_SIZE=100
OUTPUT_SIZE=4
LEARNING_RATE=0.010000
EPOCHS=100000
CSV_FILE=/tmp/iris.csv
MODEL_FILE=model.dat
==============END================
加载了 150 个样本

测试网络:
输入: [5.10, 3.50, 1.40, 0.20] 预测: 1, 真实: 1
输入: [4.90, 3.00, 1.40, 0.20] 预测: 1, 真实: 1
输入: [4.70, 3.20, 1.30, 0.20] 预测: 1, 真实: 1
输入: [4.60, 3.10, 1.50, 0.20] 预测: 1, 真实: 1
输入: [5.00, 3.60, 1.40, 0.20] 预测: 1, 真实: 1
输入: [5.40, 3.90, 1.70, 0.40] 预测: 1, 真实: 1
输入: [4.60, 3.40, 1.40, 0.30] 预测: 1, 真实: 1
输入: [5.00, 3.40, 1.50, 0.20] 预测: 1, 真实: 1
输入: [4.40, 2.90, 1.40, 0.20] 预测: 1, 真实: 1
输入: [4.90, 3.10, 1.50, 0.10] 预测: 1, 真实: 1
...
```
